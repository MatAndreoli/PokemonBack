pipeline {
    agent any
    tools {
        maven 'Maven363' 
    }
    environment {
        DATE = new Date().format('yy.M')
        TAG = "${DATE}.${BUILD_NUMBER}"
        DOCKERFILE_PATH = "src/main/docker"
    }
    stages {
        stage('Update Version') {
            steps {
                cleanWs()
                git branch: 'Main', url: 'https://github.com/MatAndreoli/PokemonBack'
                dir('PokemonBack') {
                    echo "Updating app version..."
                    sh '''
                    ls -a
                    git config --global user.name "Jenkins Pipeline"
                    git config --global user.email "jenkins@jenkins.com"
                    python3 update_version.py
                    git add .
                    git commit -m 'Jenkins Update Version'
                    '''
                }
            }
        }
    }
}
